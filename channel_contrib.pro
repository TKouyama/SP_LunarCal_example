
function channel_contrib,band_n,o_wavelength,wavelength,contrib
  if band_n eq "band1" then begin
   wavelength =  [ $
     0.512600,0.518400,0.524700,0.530400,0.536500,0.542800,0.548700 $
    ,0.554500,0.560500,0.566700,0.572600,0.578500,0.584500,0.590600 $
    ,0.596700,0.602500,0.608600,0.614600,0.620500,0.626700,0.632700 $
    ,0.638600,0.644600,0.650600,0.656600,0.662600,0.668800,0.674700 $
    ,0.680600,0.686700,0.692600,0.698600,0.704700,0.710800,0.716700 $
    ,0.722700,0.728700,0.734700,0.740700,0.746800 ]

   contrib =  [ $
     0.00000000,0.019939446,0.024258371,0.025086694,0.025315305,0.022916116 $
    ,0.022399363,0.023104539,0.023976723,0.024437275,0.024047836,0.024270577 $
    ,0.023269414,0.021014047,0.016549695,0.0096746974,0.0036697676,0.0016742860 $
    ,0.00083370986,0.00016376128,0.00010240465,0.00011084768,3.2266338e-005, 0.00000000 $
    , 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000 $
    , 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000 $
    , 0.00000000, 0.00000000, 0.00000000, 0.00000000 ]
   endif else if band_n eq "band2" then begin
     wavelength =  [ $
       0.584500,0.590600,0.596700,0.602500,0.608600,0.614600,0.620500 $
      ,0.626700,0.632700,0.638600,0.644600,0.650600,0.656600,0.662600 $
      ,0.668800,0.674700,0.680600,0.686700,0.692600,0.698600,0.704700 $
      ,0.710800,0.716700,0.722700,0.728700,0.734700,0.740700,0.746800 $
      ,0.752800,0.758700,0.764800,0.770700,0.776700 ]

     contrib =  [ $
       0.00014957042,0.00011325945,1.3309135e-005,8.0553301e-005,0.00015201289,0.00012488324 $
      ,0.00077790130,  0.012398282,  0.025268511,  0.029874754,  0.029384774,  0.028333263 $
      ,  0.028462214,  0.028317291,  0.026860415,  0.023827406,  0.023185607,  0.019277952 $
      ,  0.013594355,  0.010880887, 0.0060063413, 0.0017398607,0.00072708826,0.00028183748 $
      ,0.00010009933,  1.2478900e-005,0.00000000,0.00000000,0.00000000,0.00000000 $
      ,0.00000000,0.00000000,0.00000000 ]

  endif else if band_n eq "band3N" then begin
     wavelength =  [ $
        0.710800,0.716700,0.722700,0.728700,0.734700,0.740700,0.746800 $
       ,0.752800,0.758700,0.764800,0.770700,0.776700,0.782700,0.788800 $
       ,0.794700,0.800700,0.806800,0.812700,0.818700,0.824800,0.830800 $
       ,0.836800,0.842800,0.848800,0.854600,0.860700,0.866700,0.872700 $
       ,0.878700,0.884600,0.890700,0.896600,0.902700,0.908700,0.914600 $
       ,0.920600,0.926600,0.932600 ]

     contrib =  [ $
       0.00019118105,0.00010484723,1.8828129e-005,0.00032094148, 0.0010739967, 0.0015703808 $
       ,0.0043251283,0.010336344,0.023234276,0.025346195,0.023747922,0.025824021 $
       ,0.026113534,0.025201367,0.025060400,0.026147059,0.026120661,0.025519672 $
       ,0.025895339,0.025308266,0.024541341,0.025240219,0.024860354,0.023591690 $
       ,0.019431374,0.011917829,0.0056652474,0.0022072993,0.0010247576,0.00065806337 $
       ,0.00030790196,0.00018499169,8.5299962e-005,5.1704918e-005, 0.00000000, 0.00000000 $
       ,0.00000000, 0.00000000 ]
  endif else if band_n eq "band3B" then begin
     wavelength =  [ $
        0.710800,0.716700,0.722700,0.728700,0.734700,0.740700,0.746800 $
       ,0.752800,0.758700,0.764800,0.770700,0.776700,0.782700,0.788800 $
       ,0.794700,0.800700,0.806800,0.812700,0.818700,0.824800,0.830800 $
       ,0.836800,0.842800,0.848800,0.854600,0.860700,0.866700,0.872700 $
       ,0.878700,0.884600,0.890700,0.896600,0.902700,0.908700,0.914600 $
       ,0.920600,0.926600,0.932600 ]

     contrib =  [ $
       0.00032732240,0.00028222408,0.00024114595,0.00062449757, 0.0014964453, 0.0038432737 $
      ,0.0095681811,0.017855511,0.023110986,0.025197686,0.026097826,0.025396830 $
      ,0.024103972,0.023820984,0.023812228,0.024179585,0.024038230,0.023589736 $
      ,0.023714316,0.023578104,0.023696309,0.024057345,0.023246921,0.021799295 $
      ,0.019512299,0.013836459, 0.0074198931, 0.0035825427, 0.0018354512,0.00082699199 $
      ,0.00037333635,0.00037327243,0.00014749771,0.00042852382,0.00023489188,  1.8564238e-005 $
      ,0.00020421114,0.00038986006 ]
  endif
  wavelength*=1000.

  total_S = total(contrib)
  contrib = contrib/total_S


  arr_size=size(wavelength)
  wav_n = intarr(arr_size[1])
  tmp_siz=size(o_wavelength)
  for i=0,arr_size[1]-1,1 do begin
    tmp_m = abs(wavelength[i]-o_wavelength)
    tmp=min(tmp_m,tmp_min)
    wav_n[i] = tmp_min
  endfor
  
  return, wav_n
end